<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Posts on </title>
    <link>/posts/</link>
    <description>Recent content in Posts on </description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en</language><atom:link href="/posts/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Fishing Planet name change profanity check</title>
      <link>/posts/fishing-planet-name-change-profanity-check/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>/posts/fishing-planet-name-change-profanity-check/</guid>
      <description>If we open GameAssembly.dll in IDA pro after running Il2CppDumper to generate ida_py3.py we can search the list of functions and end up finding a function called AbusiveWords::HasAbusiveWords
Function dissassembly sparing the functions code because we don&amp;rsquo;t care about it char __fastcall HasAbusiveWords(__int64 a1, unsigned __int8 a2, __int64 a3, __int64 a4) { } Abusing it with a single hook Because this check is ran client-side and the server never confirms the name contains no profanity we can just create a signature to the function and hook it, then we just return 0, considering this game lacks an Anti-cheat we can use any hooking library we choose, for this example i went with MinHook</description>
      <content>&lt;p&gt;If we open &lt;strong&gt;GameAssembly.dll&lt;/strong&gt; in IDA pro after running &lt;a href=&#34;https://github.com/Perfare/Il2CppDumper&#34;&gt;Il2CppDumper&lt;/a&gt; to generate &lt;strong&gt;ida_py3.py&lt;/strong&gt; we can search the list of functions and end up finding a function called &lt;strong&gt;AbusiveWords::HasAbusiveWords&lt;/strong&gt;&lt;/p&gt;
&lt;h1 id=&#34;function-dissassembly-sparing-the-functions-code-because-we-dont-care-about-it&#34;&gt;Function dissassembly sparing the functions code because we don&amp;rsquo;t care about it&lt;/h1&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;char&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;__fastcall&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;HasAbusiveWords&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;__int64&lt;/span&gt; a1, &lt;span style=&#34;color:#66d9ef&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;__int8&lt;/span&gt; a2, &lt;span style=&#34;color:#66d9ef&#34;&gt;__int64&lt;/span&gt; a3, &lt;span style=&#34;color:#66d9ef&#34;&gt;__int64&lt;/span&gt; a4) { }
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;abusing-it-with-a-single-hook&#34;&gt;Abusing it with a single hook&lt;/h1&gt;
&lt;p&gt;Because this check is ran &lt;strong&gt;client-side&lt;/strong&gt; and the server never confirms the name contains no profanity we can just create a signature to the function and hook it, then we just return 0, considering this game lacks an &lt;code&gt;Anti-cheat&lt;/code&gt; we can use any hooking library we choose, for this example i went with &lt;code&gt;MinHook&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;48 89 5C 24 10 48 89 6C 24 18 56 48 83 EC 20 80 3D ? ? ? ? ? 0F B6 EA 48 8B F1 75 37&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;namespace&lt;/span&gt; AbusiveWords__HasAbusiveWords
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;typedef&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;char&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;__fastcall&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt; fn)(&lt;span style=&#34;color:#66d9ef&#34;&gt;__int64&lt;/span&gt; a1, &lt;span style=&#34;color:#66d9ef&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;__int8&lt;/span&gt; a2, &lt;span style=&#34;color:#66d9ef&#34;&gt;__int64&lt;/span&gt; a3, &lt;span style=&#34;color:#66d9ef&#34;&gt;__int64&lt;/span&gt; a4);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;inline&lt;/span&gt; fn original;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;extern&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;char&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;__fastcall&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;hooked&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;__int64&lt;/span&gt; a1, &lt;span style=&#34;color:#66d9ef&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;__int8&lt;/span&gt; a2, &lt;span style=&#34;color:#66d9ef&#34;&gt;__int64&lt;/span&gt; a3, &lt;span style=&#34;color:#66d9ef&#34;&gt;__int64&lt;/span&gt; a4);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;char&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;__fastcall&lt;/span&gt; AbusiveWords__HasAbusiveWords&lt;span style=&#34;color:#f92672&#34;&gt;::&lt;/span&gt;hooked(&lt;span style=&#34;color:#66d9ef&#34;&gt;__int64&lt;/span&gt; a1, &lt;span style=&#34;color:#66d9ef&#34;&gt;unsigned&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;__int8&lt;/span&gt; a2, &lt;span style=&#34;color:#66d9ef&#34;&gt;__int64&lt;/span&gt; a3, &lt;span style=&#34;color:#66d9ef&#34;&gt;__int64&lt;/span&gt; a4)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; false;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;hook&lt;/span&gt;()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (MH_Initialize() &lt;span style=&#34;color:#f92672&#34;&gt;!=&lt;/span&gt; MH_OK)&lt;span style=&#34;color:#75715e&#34;&gt;//initialize minhook
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;uint64_t&lt;/span&gt; has_abusive_words &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; signature_scan&lt;span style=&#34;color:#f92672&#34;&gt;::&lt;/span&gt;scan(x&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;GameAssembly.dll&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;48 89 5C 24 10 48 89 6C 24 18 56 48 83 EC 20 80 3D ? ? ? ? ? 0F B6 EA 48 8B F1 75 37&amp;#34;&lt;/span&gt;);&lt;span style=&#34;color:#75715e&#34;&gt;//scan for the function using the signature we created earlier
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; successfully_hooked &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; MH_CreateHook((LPVOID)has_abusive_words, &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;AbusiveWords__HasAbusiveWords&lt;span style=&#34;color:#f92672&#34;&gt;::&lt;/span&gt;hooked, &lt;span style=&#34;color:#66d9ef&#34;&gt;reinterpret_cast&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;LPVOID&lt;span style=&#34;color:#f92672&#34;&gt;*&amp;gt;&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;AbusiveWords__HasAbusiveWords&lt;span style=&#34;color:#f92672&#34;&gt;::&lt;/span&gt;original)) &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; MH_OK;&lt;span style=&#34;color:#75715e&#34;&gt;//create the hook and confirm it was created
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; successfully_enabled &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; MH_EnableHook(MH_ALL_HOOKS) &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; MH_OK;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content>
    </item>
    
  </channel>
</rss>
